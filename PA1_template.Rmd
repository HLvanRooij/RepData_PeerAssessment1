---
title: "PA1_Jeroen van Rooij"
author: "Jeroen van Rooij"
date: "27 maart 2019"
output: html_document
---

### Loading and preprocessing the data 

**1. Load the data**  

* import the file in a temporary file  
* unzip the file and read it into the R environment  

``` {r}
temp <- tempfile()
download.file("https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip",temp)
activity <- read.csv(unzip(temp, "activity.csv"))
unlink(temp)
``` 
  
  
**2. Process the data**   

* Convert the date column to date format  
    
    
```{r}
activity$date <- as.Date(activity$date, "%Y-%m-%d")

```
  
  
  
  
### What is mean total number of steps taken per day?

**1. Make a histogram of the total number of steps taken each day**  
  
  
The first step is to create a new table containing:    
  
* Aggregate the number of steps per day   
* NA values will be excluded in this step  

```{r}

activity.ex.na.daily <- aggregate(activity[, 1], by = list(activity$date), FUN = sum, na.rm = TRUE)

```

The next step is to create the histogram. The graph shows the number of days that a certain amount of steps have been taken 

```{r}

hist(activity.ex.na.daily$x, 
     ylab = "Frequency of days", 
     xlab = "Number of Steps per days ", 
     main = "Histogram of the steps taken per day", 
     breaks = 10
     )
```


**2. Calculate and report the mean and median total number of steps taken per day**

```{r}
mean.steps.daily <- mean(activity.ex.na.daily$x)
median.steps.daily <- median(activity.ex.na.daily$x)
```

The mean steps taken by day is **`r round(mean.steps.daily, 2)`** and the median is **`r median.steps.daily`**  

### What is the average daily activity pattern?  
  

**1. Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)**  

* The first step is to average the activity by interval, for all days  
* Remove NA in the process  

``` {r} 
activity.ex.na.interval <- aggregate(activity$steps, by = list(activity$interval), na.rm = TRUE,FUN = mean)
```
  
  
* The next step is to create the linechart   


``` {r}
plot(activity.ex.na.interval$Group.1, activity.ex.na.interval$x, 
      type = "l",
     ylab = "Average number of steps",
     xlab = "Interval", 
     main = "Average activity during the day")
 
```
  
  
** 2. Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps? **  
```{r}
activity.ex.na.interval[activity.ex.na.interval$x == max(activity.ex.na.interval$x), "Group.1"]
```


